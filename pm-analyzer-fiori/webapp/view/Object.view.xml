<mvc:View
    controllerName="com.sap.pm.pmanalyzerfiori.controller.Object"
    xmlns="sap.m"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:f="sap.ui.layout.form"
    xmlns:l="sap.ui.layout"
    xmlns:microchart="sap.suite.ui.microchart">
    <Page
        id="page"
        title="Analysis Wizard: {NotificationId}"
        showNavButton="true"
        navButtonPress=".onNavBack">
        <content>
            <Wizard
                id="analysisWizard"
                class="sapUiResponsivePadding--header sapUiResponsivePadding--content"
                finishButtonText="Finish"
                showNextButton="false"
                cancel=".onNavBack"
                complete=".onNavBack">
                <!-- Step 1: Review and Refine Data -->
                <WizardStep
                    id="dataStep"
                    title="Review &amp; Refine Data"
                    validated="true">
                    <MessageStrip
                        text="You can edit the text here to perform a 'what-if' analysis and see how changes impact the quality score."
                        type="Information"
                        showIcon="true"
                        class="sapUiSmallMarginBottom" />
                    <f:SimpleForm layout="ResponsiveGridLayout">
                        <f:content>
                            <Label text="Long Text"/>
                            <TextArea id="longText" value="{LongText}" rows="8" width="100%"/>
                            <Label text="Activities"/>
                            <TextArea id="activitiesText" value="{Activities}" rows="8" width="100%"/>
                        </f:content>
                    </f:SimpleForm>
                    <Button text="Proceed to Analysis" type="Emphasized" press=".validateAndNext" class="sapUiSmallMarginTop"/>
                </WizardStep>

                <!-- Step 2: View Analysis Result -->
                <WizardStep
                    id="analysisStep"
                    title="Analysis Result"
                    validated="true">
                     <VBox class="sapUiSmallMarginTop" busy="{analysis>/busy}" busyIndicatorDelay="0">
                        <Panel id="resultsPanel" visible="{analysis>/resultsVisible}" backgroundDesign="Transparent">
                            <FlexBox width="100%" alignItems="Start">
                                <VBox>
                                    <layoutData>
                                        <FlexItemData growFactor="2" />
                                    </layoutData>
                                    <f:SimpleForm layout="ResponsiveGridLayout">
                                        <f:content>
                                            <Label text="Summary"/>
                                            <Text text="{analysis>/summary}" />
                                            <Label text="Identified Problems"/>
                                            <Text text="{path: 'analysis>/problems', formatter:'.formatProblems'}" renderWhitespace="true" />
                                        </f:content>
                                    </f:SimpleForm>
                                </VBox>
                                <VBox justifyContent="Center" alignItems="Center" class="sapUiSmallMarginBegin">
                                    <layoutData>
                                        <FlexItemData growFactor="1" />
                                    </layoutData>
                                    <Title text="Quality Score" level="H5" class="sapUiSmallMarginBottom" />
                                    <microchart:RadialMicroChart
                                        id="scoreGauge"
                                        percentage="{analysis>/score}"
                                        size="L"
                                        valueColor="{= ${analysis>/score} > 70 ? 'Good' : (${analysis>/score} >= 50 ? 'Critical' : 'Error') }" />
                                </VBox>
                            </FlexBox>
                        </Panel>
                    </VBox>
                </WizardStep>
            </Wizard>
        </content>
    </Page>
</mvc:View>
